<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Products</title>
  <!--favicon-->
  <link rel="icon" type="image/png" href="images/icons/favicon2.png" sizes="16x16">
  <link href="https://fonts.googleapis.com/css?family=Lora:400,700|Montserrat:300" rel="stylesheet">
  <link href="https://fonts.googleapis.com/css?family=Chivo:300,700|Playfair+Display:700i" rel="stylesheet">
  <link rel="stylesheet" href="css/style_index.css">
  <link rel="stylesheet" href="css/categories.css">
  <link rel="stylesheet" href="css/products.css">
  <link rel="stylesheet" href="css/nav.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script>
</head>
<body>
  <!-- navbar -->
  <nav> 
    <div class="logo">
      <h3><a href="merlin.html" class="logo-name">E commerce</a></h3>
    </div>
    <ul class="nav-links">
      <li><a href="index.html">Home</a></li>
      <li><a href="products.html">Products</a></li>
      <li><a href="categories.html">Categories</a></li>
      <li><a href="cart.html">Cart </a></li>
      <li><a href="contact.html">ContactUs</a></li>
      <li><a href="profile.html">Profile</a></li>
      <li><a href="login.html" id="login">Login</a></li>
    </ul>
    <div class="burger">
      <div class="line1"></div>
      <div class="line2"></div>
      <div class="line3"></div>
    </div>
  </nav>
  <!-- navbar -->
  <h2 class="main-head-of-products">Everyone Has A Style Statement<br>
    <span class="colored-word-bigger-size">FIND YOURS HERE!</span>
  </h2>
  <br>
  <div class="bg-images">
    <a href="products.html"><img src="images/products-img/marcus-loke-xXJ6utyoSw0-unsplash (1).jpg" alt=""></a>
  </div>
  <center><p class="msg-ps">
    <span class="colored-word">Click</span> on the product to add it to your shopping list.
    <br>Go below and check <span class="colored-word">YOUR CART</span> for details.
  </p></center>
  <div id="products-container"></div>

  <script>
    // Fetch products from the server and display them
    fetch('http://localhost:3000/api/products') // Make sure this points to your backend server
      .then(response => {
        console.log('Response:', response); // Log the response
        return response.json();
      })
      .then(products => {
        console.log('Products:', products); // Log the products
        const productsContainer = document.getElementById('products-container');
        products.forEach(product => {
          const productElement = document.createElement('div');
          productElement.className = 'product';
          productElement.innerHTML = `
            <img src="${product.imageUrl}" alt="${product.name}">
            <h2>${product.name}</h2>
            <p>${product.description}</p>
            <p>$${product.price}</p>
            <button onclick="addToCart(${product.id})">Add to Cart</button>
          `;
          productsContainer.appendChild(productElement);
        });
      })
      .catch(error => {
        console.error('Error fetching products:', error); // Log any errors
      });
  
    function addToCart(productId) {
      const userId = getCurrentUserId();
      fetch('http://localhost:3000/api/cart', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json'
        },
        body: JSON.stringify({ userId, productId })
      }).then(response => response.json())
        .then(data => {
          if (data.message) {
            alert(data.message);
          }
        });
    }
  
    function getCurrentUserId() {
      // Dummy function to get user ID; replace with actual implementation
      return 1; // Replace with actual user ID logic
    }
  </script>
  

  <script src="nav.js"></script>
  <script src="js/products.js"></script>
</body>
</html>
